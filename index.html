<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Restaurant POS PRO</title>

<style>
body{font-family:Arial;background:#f4f6f8;margin:0;padding:15px;}
.card{background:#fff;padding:15px;border-radius:12px;margin-bottom:15px;box-shadow:0 2px 6px rgba(0,0,0,0.1);}
button{padding:10px;border:none;border-radius:8px;margin:4px;font-size:14px;cursor:pointer;}
.dark{background:#111;color:#fff;width:100%;}
.light{background:#ddd;width:100%;}
.nav{display:flex;gap:5px;margin-bottom:10px;}
.nav button{flex:1;}
.menu-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.hidden{display:none;}
input{width:100%;padding:8px;margin:5px 0;border-radius:6px;border:1px solid #ccc;}
.section-title{font-weight:bold;margin-bottom:5px;}

#paymentButtons{display:flex;flex-wrap:wrap;gap:5px;margin:10px 0;}
.pay-btn{background:#ddd;width:48%;}
.pay-btn.active{background:#4CAF50;color:white;}

.bill-list{margin-top:10px;}

.data-grid{
display:grid;
grid-template-columns:1fr 1fr;
gap:15px;
}

.data-box{
background:#f9f9f9;
padding:10px;
border-radius:8px;
font-size:13px;
}

.income-box{border-left:5px solid #4CAF50;}
.expense-box{border-left:5px solid #f44336;}

.toast{
position:fixed;
top:20px;
right:20px;
background:#4CAF50;
color:white;
padding:12px 18px;
border-radius:8px;
box-shadow:0 4px 10px rgba(0,0,0,0.2);
opacity:0;
transition:0.3s;
z-index:999;
}
.toast.show{opacity:1;}
</style>
</head>

<body>

<div class="nav">
<button onclick="show('home')">üè†</button>
<button onclick="show('income')">üí∞</button>
<button onclick="show('expense')">üí∏</button>
<button onclick="show('data')">üìä</button>
<button onclick="resetData()">üóë</button>
</div>

<!-- DASHBOARD -->
<div id="home" class="card">
<h3>‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h3>

<div>üíµ ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î: <span id="cashTotal">0</span></div>
<div>üì± ‡πÇ‡∏≠‡∏ô: <span id="transferTotal">0</span></div>
<div>üü¢üõµ Grab: <span id="grabTotal">0</span></div>
<div>üü©üõµ LINE MAN: <span id="linemanTotal">0</span></div>

<hr>
<div><strong>‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏ß‡∏°:</strong> <span id="incomeTotal">0</span></div>
<div><strong>‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏ß‡∏°:</strong> <span id="expenseTotal">0</span></div>
<div><strong>‡∏Å‡∏≥‡πÑ‡∏£:</strong> <span id="profitTotal">0</span></div>
</div>

<!-- INCOME -->
<div id="income" class="card hidden">
<h3>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</h3>

<div class="menu-grid">
<div>
<div class="section-title">‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</div>
<button class="light" onclick="addMenu('‡∏ô‡πâ‡∏≥‡∏¢‡∏≤‡∏õ‡∏•‡∏≤',50)">‡∏ô‡πâ‡∏≥‡∏¢‡∏≤‡∏õ‡∏•‡∏≤ 50</button>
<button class="light" onclick="addMenu('‡∏ô‡πâ‡∏≥‡∏¢‡∏≤‡∏õ‡πà‡∏≤',50)">‡∏ô‡πâ‡∏≥‡∏¢‡∏≤‡∏õ‡πà‡∏≤ 50</button>
<button class="light" onclick="addMenu('‡∏ô‡πâ‡∏≥‡∏¢‡∏≤‡∏ú‡∏™‡∏°',50)">‡∏ô‡πâ‡∏≥‡∏¢‡∏≤‡∏ú‡∏™‡∏° 50</button>
<button class="light" onclick="addMenu('‡∏ô‡πâ‡∏≥‡∏¢‡∏≤‡∏õ‡∏π',70)">‡∏ô‡πâ‡∏≥‡∏¢‡∏≤‡∏õ‡∏π 70</button>
</div>
<div>
<div class="section-title">Add On</div>
<button class="light" onclick="addMenu('‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô',10)">‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô 10</button>
<button class="light" onclick="addMenu('‡πÄ‡∏ó‡πâ‡∏≤‡πÑ‡∏Å‡πà',20)">‡πÄ‡∏ó‡πâ‡∏≤‡πÑ‡∏Å‡πà 20</button>
<button class="light" onclick="addMenu('‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô+‡πÄ‡∏ó‡πâ‡∏≤‡πÑ‡∏Å‡πà',20)">‡∏•‡∏π‡∏Å‡∏ä‡∏¥‡πâ‡∏ô+‡πÄ‡∏ó‡πâ‡∏≤‡πÑ‡∏Å‡πà 20</button>
<button class="light" onclick="addMenu('‡∏Ç‡∏ô‡∏°‡∏à‡∏µ‡∏ô',10)">‡∏Ç‡∏ô‡∏°‡∏à‡∏µ‡∏ô 10</button>
<button class="light" onclick="addMenu('‡πÑ‡∏Ç‡πà‡∏ï‡πâ‡∏°',10)">‡πÑ‡∏Ç‡πà‡∏ï‡πâ‡∏° 10</button>
</div>
</div>

<!-- ‡∏õ‡∏∏‡πà‡∏°‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô -->
<div id="paymentButtons">
<button class="pay-btn active" onclick="selectPayment('‡∏™‡∏î',this)">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</button>
<button class="pay-btn" onclick="selectPayment('‡πÇ‡∏≠‡∏ô',this)">‡πÇ‡∏≠‡∏ô</button>
<button class="pay-btn" onclick="selectPayment('Grab',this)">Grab</button>
<button class="pay-btn" onclick="selectPayment('LINE MAN',this)">LINE MAN</button>
</div>

<div class="bill-list">
<h4>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏ö‡∏¥‡∏•</h4>
<div id="billList">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
<div><strong>‡∏£‡∏ß‡∏°: <span id="billTotal">0</span> ‡∏ö‡∏≤‡∏ó</strong></div>
</div>

<button onclick="clearBill()">‡∏•‡πâ‡∏≤‡∏á‡∏ö‡∏¥‡∏•</button>
<button class="dark" onclick="saveIncome()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</button>
</div>

<!-- EXPENSE -->
<div id="expense" class="card hidden">
<h3>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</h3>

<input type="text" id="expenseNote" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î">
<input type="number" id="expenseAmount" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô">

<button class="dark" onclick="saveExpense()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</button>
</div>

<!-- DATA -->
<div id="data" class="card hidden">
<h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á</h3>
<button onclick="exportExcel()">üì• Export Excel</button>
<div id="allData"></div>
</div>

<script>
function today(){return new Date().toISOString().split("T")[0];}
function nowTime(){return new Date().toLocaleTimeString();}
let db=JSON.parse(localStorage.getItem("restaurantDB"))||{};
let currentBill=[];
let selectedPayment="‡∏™‡∏î";

function selectPayment(type,btn){
selectedPayment=type;
document.querySelectorAll(".pay-btn").forEach(b=>b.classList.remove("active"));
btn.classList.add("active");
}

function show(p){
["home","income","expense","data"].forEach(id=>{
document.getElementById(id).classList.add("hidden");
});
document.getElementById(p).classList.remove("hidden");
updateDashboard();
renderAllData();
}

function addMenu(name,price){
currentBill.push({name,price});
renderBill();
}

function renderBill(){
if(currentBill.length===0){
document.getElementById("billList").innerHTML="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£";
document.getElementById("billTotal").innerText=0;
return;
}
let total=0,html="";
currentBill.forEach((i,index)=>{
total+=i.price;
html+=`${i.name} - ${i.price} ‡∏ö‡∏≤‡∏ó 
<button onclick="removeItem(${index})">‚ùå</button><br>`;
});
document.getElementById("billList").innerHTML=html;
document.getElementById("billTotal").innerText=total;
}

function removeItem(i){
currentBill.splice(i,1);
renderBill();
}

function clearBill(){
currentBill=[];
renderBill();
}

function saveIncome(){
if(currentBill.length===0)return;
let t=today();
if(!db[t])db[t]={income:[],expense:[]};
let total=currentBill.reduce((a,b)=>a+b.price,0);
db[t].income.unshift({
items:[...currentBill],
total,
payment:selectedPayment,
time:nowTime()
});
currentBill=[];
renderBill();
saveDB();
updateDashboard();
renderAllData();
}

function saveExpense(){
let t=today();
if(!db[t])db[t]={income:[],expense:[]};
let amt=Number(document.getElementById("expenseAmount").value)||0;
let note=document.getElementById("expenseNote").value||"-";
db[t].expense.unshift({amount:amt,note,time:nowTime()});
document.getElementById("expenseAmount").value="";
document.getElementById("expenseNote").value="";
saveDB();
updateDashboard();
renderAllData();
}

function updateDashboard(){
let t=today();
if(!db[t]){
document.getElementById("cashTotal").innerText=0;
document.getElementById("transferTotal").innerText=0;
document.getElementById("grabTotal").innerText=0;
document.getElementById("linemanTotal").innerText=0;
document.getElementById("incomeTotal").innerText=0;
document.getElementById("expenseTotal").innerText=0;
document.getElementById("profitTotal").innerText=0;
return;
}
let cash=0,transfer=0,grab=0,lineman=0;
(db[t].income||[]).forEach(b=>{
if(b.payment==="‡∏™‡∏î")cash+=b.total;
if(b.payment==="‡πÇ‡∏≠‡∏ô")transfer+=b.total;
if(b.payment==="Grab")grab+=b.total;
if(b.payment==="LINE MAN")lineman+=b.total;
});
let income=cash+transfer+grab+lineman;
let expense=(db[t].expense||[]).reduce((a,b)=>a+b.amount,0);
document.getElementById("cashTotal").innerText=cash;
document.getElementById("transferTotal").innerText=transfer;
document.getElementById("grabTotal").innerText=grab;
document.getElementById("linemanTotal").innerText=lineman;
document.getElementById("incomeTotal").innerText=income;
document.getElementById("expenseTotal").innerText=expense;
document.getElementById("profitTotal").innerText=income-expense;
}

function renderAllData(){
let html='<div class="data-grid">';
let dates=Object.keys(db).sort().reverse();
dates.forEach(date=>{
html+=`<div><h4>${date}</h4>`;
(db[date].income||[]).forEach(b=>{
html+=`<div class="data-box income-box">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ${b.payment} ${b.total} ‡∏ö‡∏≤‡∏ó ${b.time}</div>`;
});
html+='</div>';
html+=`<div><h4>${date}</h4>`;
(db[date].expense||[]).forEach(e=>{
html+=`<div class="data-box expense-box">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ ${e.note} ${e.amount} ‡∏ö‡∏≤‡∏ó ${e.time}</div>`;
});
html+='</div>';
});
html+='</div>';
document.getElementById("allData").innerHTML=html;
}

function exportExcel(){
let csv="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà,‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó,‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î,‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô,‡πÄ‡∏ß‡∏•‡∏≤\n";
Object.keys(db).forEach(date=>{
(db[date].income||[]).forEach(b=>{
csv+=`${date},‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö,${b.payment},${b.total},${b.time}\n`;
});
(db[date].expense||[]).forEach(e=>{
csv+=`${date},‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢,${e.note},${e.amount},${e.time}\n`;
});
});
let blob=new Blob([csv],{type:"text/csv"});
let link=document.createElement("a");
link.href=URL.createObjectURL(blob);
link.download="restaurant-data.csv";
link.click();
}

function resetData(){
localStorage.removeItem("restaurantDB");
location.reload();
}

function saveDB(){
localStorage.setItem("restaurantDB",JSON.stringify(db));
}

updateDashboard();
renderAllData();
renderBill();
</script>

</body>
</html>
